import{_ as S,u as I,r,c as m,o as V,a as k,b as s,d as q,w as C,e as g,v as h,t as D,f as b,g as t,h as L,i as U}from"./index-BQ1hpIGG.js";const B={class:"login-container"},F={class:"login-card"},P={class:"form-group"},M={class:"form-group"},N={class:"captcha-container"},R=["disabled"],$=["disabled"],A={__name:"Login",setup(E){const d=L(),_=I(),o=r(""),c=r(""),l=r(!1),i=r(60),u=r(null),v=m(()=>/^1[3-9]\d{9}$/.test(o.value)),p=m(()=>v.value&&c.value.length===6),y=async()=>{if(!v.value){t.error("请输入有效的手机号");return}try{l.value=!0,await b.sendCode(o.value),t.success("验证码发送成功"),i.value=60,u.value=setInterval(()=>{i.value--,i.value<=0&&(clearInterval(u.value),l.value=!1)},1e3)}catch(a){console.error("Failed to send code:",a),t.error("验证码发送失败，请重试"),l.value=!1}},w=async()=>{if(p.value)try{const a=await b.login(o.value,c.value);if(a&&a.code===200){const e=a.profile,n=a.token,x=Date.now()+10080*60*1e3;_.setLoginStatus({userInfo:e,token:n,expires:x}),t.success("登录成功");const f=d.currentRoute.value.query.redirect;f?d.push(f):d.push("/")}else t.error("登录失败，请检查手机号和验证码")}catch(a){console.error("Failed to login:",a),t.error("登录失败，请重试")}};return V(()=>{u.value&&clearInterval(u.value)}),(a,e)=>(U(),k("div",B,[s("div",F,[e[4]||(e[4]=s("div",{class:"logo-container"},[s("h1",{class:"logo-text"},"YPlayer"),s("p",{class:"slogan"},"网易云音乐网页播放器")],-1)),s("form",{class:"login-form",onSubmit:C(w,["prevent"])},[s("div",P,[e[2]||(e[2]=s("label",{for:"phone",class:"form-label"},"手机号",-1)),g(s("input",{type:"tel",id:"phone","onUpdate:modelValue":e[0]||(e[0]=n=>o.value=n),class:"form-input",placeholder:"请输入手机号",required:"",maxlength:"11"},null,512),[[h,o.value]])]),s("div",M,[e[3]||(e[3]=s("label",{for:"captcha",class:"form-label"},"验证码",-1)),s("div",N,[g(s("input",{type:"text",id:"captcha","onUpdate:modelValue":e[1]||(e[1]=n=>c.value=n),class:"form-input captcha-input",placeholder:"请输入验证码",required:"",maxlength:"6"},null,512),[[h,c.value]]),s("button",{type:"button",class:"send-code-btn",disabled:l.value||!v.value,onClick:y},D(l.value?`${i.value}s`:"获取验证码"),9,R)])]),s("button",{type:"submit",class:"login-btn",disabled:!p.value},"登录",8,$)],32),e[5]||(e[5]=q('<div class="other-login" data-v-2518cc02><p data-v-2518cc02>其他登录方式</p><div class="social-icons" data-v-2518cc02><span class="icon wechat" data-v-2518cc02></span><span class="icon qq" data-v-2518cc02></span><span class="icon weibo" data-v-2518cc02></span></div></div>',1))])]))}},Y=S(A,[["__scopeId","data-v-2518cc02"]]);export{Y as default};
